
- alias: 'Alarm clock: Weather notification'
  id: "alarm_clock_weather_notification"
  trigger:
    platform: template
    value_template: >
      {{ states("sensor.time")[0:5] == states("sensor.weather_notifitcations") }}
  action:
    service: telegram_bot.send_message
    data:
      message: "{% if now().strftime('%H')|int < 7 %}
        Доброй ночи,
        {% elif now().strftime('%H')|int < 12 %}
        Доброе утро,
        {% elif now().strftime('%H')|int < 18 %}
        Хорошего дня,
        {% else %}
        Хорошего вечера,
        {% endif %}
         сейчас в Санкт-Петербурге {{ state_attr('weather.home','temperature') }}°C. Ветер {{ state_attr('weather.home','wind_speed') }}м/с."


- alias: "Alarm clock: Sunrise wake up"
  id: "alarm_clock_sunrise"
  trigger:
    platform: template
    value_template: >
      {{ states("sensor.time")[0:5] == states("sensor.wake_up_light_start_time") }}
  condition:
    condition: state
    entity_id: input_boolean.alarm_clock
    state: "on"
  action:
    - service: input_boolean.turn_off
      entity_id:
        - switch.adaptive_lighting_sleep_mode_bed_room
        - switch.adaptive_lighting_bed_room
    - service: input_boolean.turn_on
      entity_id: input_boolean.wake_up_light



- alias: "Alarm clock: Actions exactly at alarm time"
  trigger:
    - platform: template
      value_template: >
        {{ states("sensor.time")[0:5] == states("sensor.alarm_clock") }}
  action:
    - service: input_boolean.turn_on
      entity_id:
        - switch.adaptive_lighting_bed_room
        # можно выключить режим сна здесь, но лучше выключить через shortcuts, когда сработает событие wake up
    # - service: input_select.select_option
    #   entity_id: input_select.sleep_mode
    #   data:
    #     option: "off"



- alias: "Alarm clock: Charging time"
  trigger:
    platform: template
    value_template: >
      {{ states("sensor.time")[0:5] == states("sensor.charging_time") }}
  condition:
    condition: state
    entity_id: input_boolean.alarm_clock
    state: "on"
  action:
    - service: switch.turn_on
      entity_id: switch.smart_plug_bedroom

